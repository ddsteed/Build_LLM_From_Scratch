(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[      8797,        223]
NotebookOptionsPosition[      7270,        185]
NotebookOutlinePosition[      7735,        202]
CellTagsIndexPosition[      7692,        199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Sebastian Raschka",
  FontFamily->"FZLanTingHei-DB-GBK",
  FontSize->12,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.8488288700694285, 0.3848325322346838, 0.1479972533760586]],
 StyleBox["\[LineSeparator]",
  FontSize->12,
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["\n",
  FontSize->12,
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["Build a LLM from Scratch: Fine-tuning for classification",
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontSlant->"Italic",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox["                                ",
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox[ButtonBox["<",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{$RootDirectory, "Users", "fengh", "Documents", "RDS", 
      "EDITED", "Build_a_LLM_from_Scratch"}, "BLLM-5-Pretraining.nb", 
     CharacterEncoding -> "UTF-8"], None},
  ButtonNote->
   "/Users/fengh/Documents/RDS/EDITED/Build_a_LLM_from_Scratch/BLLM-5-\
Pretraining.nb"],
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox[" ",
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox[ButtonBox[">",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{$RootDirectory, "Users", "fengh", "Documents", "RDS", 
      "EDITED", "Build_a_LLM_from_Scratch"}, 
     "BLLM-7-Fine-tuning-to-follow-instructions.nb", CharacterEncoding -> 
     "UTF-8"], None},
  ButtonNote->
   "/Users/fengh/Documents/RDS/EDITED/Build_a_LLM_from_Scratch/BLLM-7-Fine-\
tuning-to-follow-instructions.nb"],
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox["    ",
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox[ButtonBox["\[CapitalXi]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{$RootDirectory, "Users", "fengh", "Documents", "RDS", 
      "EDITED", "MPAAI"}, "contents.nb", CharacterEncoding -> "UTF-8"], None},
  
  ButtonNote->"/Users/fengh/Documents/RDS/EDITED/MPAAI/contents.nb"],
  FontFamily->"Arial Unicode MS",
  FontSize->17.5,
  FontWeight->"Regular",
  FontColor->RGBColor[
   0.9866483558403907, 0.9388876173037308, 0.6336003662165255]],
 StyleBox["\[LineSeparator]\[LineSeparator]",
  FontSize->12,
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["Edited by Hao Feng",
  FontFamily->"Futura",
  FontSize->12,
  FontWeight->"Medium",
  FontSlant->"Italic",
  FontColor->RGBColor[
   0.8488288700694285, 0.3848325322346838, 0.1479972533760586]]
}], "Text",
 CellMargins->{{66, -45}, {4, 12}},
 CellChangeTimes->{{3.9397640484222183`*^9, 3.939764052679113*^9}, 
   3.9397641564677134`*^9, 3.939764214184162*^9, {3.939774845841297*^9, 
   3.9397748486786137`*^9}, 3.9397769383984737`*^9, 3.939777524212697*^9, {
   3.939777679887363*^9, 3.9397776986053457`*^9}, 3.939777748637487*^9, 
   3.939777854556375*^9, {3.939778004745451*^9, 3.939778004752576*^9}, {
   3.939778088573533*^9, 3.9397780885805683`*^9}, {3.9397839690765333`*^9, 
   3.9397839824858227`*^9}, 3.939948605500866*^9, {3.940303093496327*^9, 
   3.940303093503997*^9}, {3.940303242886895*^9, 3.940303242893952*^9}, 
   3.940741017163128*^9, {3.940741096570195*^9, 3.940741115877015*^9}, {
   3.940741256704732*^9, 3.9407412567117643`*^9}, {3.941400477782477*^9, 
   3.941400515893614*^9}, {3.941400729083743*^9, 3.941400737654318*^9}, {
   3.941401219677822*^9, 3.941401235512442*^9}},
 LineSpacing->{0.6999999999999997, 3},
 Background->RGBColor[
  0.13066300450141147`, 0.12460517280842298`, 0.4353551537346456],
 CellID->912160115,ExpressionUUID->"43c10951-a2d7-4bae-8da9-a50305d2dac3"],

Cell[CellGroupData[{

Cell["6 Fine-tuning for classification", "Chapter",
 CellChangeTimes->{{3.942109155280294*^9, 3.9421091619989653`*^9}},
 CellID->1380243901,ExpressionUUID->"0e01b05f-4670-4bcb-b418-38bf39c51d63"],

Cell[TextData[StyleBox["This chapter covers",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109172930848*^9}},
 CellID->601695449,ExpressionUUID->"61816a3a-5a22-4cca-b30f-b9fc406f177a"],

Cell[CellGroupData[{

Cell["Introducing different LLM fine-tuning approaches", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109187301667*^9}},
 CellID->1299077676,ExpressionUUID->"74ca88f2-0939-4280-a6b9-538b37b509bf"],

Cell["Preparing a dataset for text classification", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109190516446*^9}},
 CellID->1962685342,ExpressionUUID->"a65b1990-654d-40f6-b357-f0b7df8a75d0"],

Cell["Modifying a pretrained LLM for fine-tuning", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.9421091913906107`*^9}},
 CellID->1216975851,ExpressionUUID->"179b7320-43d9-4fec-a536-0304e78d42bc"],

Cell["Fine-tuning an LLM to identify spam messages", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109192566824*^9}},
 CellID->289037716,ExpressionUUID->"3bca25a7-6f6b-4b90-ba1e-182d47c182bf"],

Cell["Evaluating the accuracy of a fine-tuned LLM classifier", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109193285758*^9}},
 CellID->990512105,ExpressionUUID->"1bee0725-20c3-4c6a-8dd2-fd5a92935e48"],

Cell["Using a fine-tuned LLM to classify new data", "Item",
 CellChangeTimes->{{3.942109168798585*^9, 3.942109176065137*^9}},
 CellID->1726925791,ExpressionUUID->"7a491314-e9f6-4327-8e1a-f0fa21748f3f"]
}, Open  ]],

Cell["\<\
So far, we have coded the LLM architecture, pretrained it,
and learned how to import pretrained weights from an
external source, such as OpenAI, into our model. Now we
will reap the fruits of our labor by fine-tuning the LLM on a
specific target task, such as classifying text. The concrete
example we examine is classifying text messages as \
\[OpenCurlyDoubleQuote]spam\[CloseCurlyDoubleQuote]
or \[OpenCurlyDoubleQuote]not spam.\[CloseCurlyDoubleQuote] Figure 6.1 \
highlights the two main ways of
fine-tuning an LLM: fine-tuning for classification (step 8) and
fine-tuning to follow instructions (step 9).\
\>", "Text",
 CellChangeTimes->{3.942109168798585*^9},
 CellID->1997922113,ExpressionUUID->"55a0427a-b9a4-4238-b181-4fe16dd6cee7"]
}, Open  ]]
},
WindowSize->{960, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "BookToolsStyles.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"905d2a50-0b58-46dd-b30d-96e410c6c0be"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 4232, 108, 130, "Text",ExpressionUUID->"43c10951-a2d7-4bae-8da9-a50305d2dac3",
 CellID->912160115],
Cell[CellGroupData[{
Cell[4811, 132, 195, 2, 84, "Chapter",ExpressionUUID->"0e01b05f-4670-4bcb-b418-38bf39c51d63",
 CellID->1380243901],
Cell[5009, 136, 217, 3, 45, "Text",ExpressionUUID->"61816a3a-5a22-4cca-b30f-b9fc406f177a",
 CellID->601695449],
Cell[CellGroupData[{
Cell[5251, 143, 206, 2, 38, "Item",ExpressionUUID->"74ca88f2-0939-4280-a6b9-538b37b509bf",
 CellID->1299077676],
Cell[5460, 147, 201, 2, 38, "Item",ExpressionUUID->"a65b1990-654d-40f6-b357-f0b7df8a75d0",
 CellID->1962685342],
Cell[5664, 151, 202, 2, 38, "Item",ExpressionUUID->"179b7320-43d9-4fec-a536-0304e78d42bc",
 CellID->1216975851],
Cell[5869, 155, 201, 2, 38, "Item",ExpressionUUID->"3bca25a7-6f6b-4b90-ba1e-182d47c182bf",
 CellID->289037716],
Cell[6073, 159, 211, 2, 38, "Item",ExpressionUUID->"1bee0725-20c3-4c6a-8dd2-fd5a92935e48",
 CellID->990512105],
Cell[6287, 163, 201, 2, 38, "Item",ExpressionUUID->"7a491314-e9f6-4327-8e1a-f0fa21748f3f",
 CellID->1726925791]
}, Open  ]],
Cell[6503, 168, 751, 14, 281, "Text",ExpressionUUID->"55a0427a-b9a4-4238-b181-4fe16dd6cee7",
 CellID->1997922113]
}, Open  ]]
}
]
*)

